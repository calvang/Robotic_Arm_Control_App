(this.webpackJsonpcontrol_app=this.webpackJsonpcontrol_app||[]).push([[0],{40:function(e){e.exports=JSON.parse('{"a":[{"name":"Simple Control","desc":"A sequence of basic movements in control mode","type":"control","length":3,"data":[[90,45,-30,-30,180,1],[-120,-30,19,45,-180,0],[120,30,19,45,-180,1]]},{"name":"Simple Automatic","desc":"A sequence of basic movements in automatic mode","type":"automatic","length":3,"data":[[1,1,1],[1,2,1],[2,1,1]]},{"name":"Back and Forth","desc":"Funny Dance","type":"automatic","length":16,"data":[[2,1,0],[-2,1,0],[2,1,0],[-2,1,0],[2,1,0],[-2,1,0],[2,1,0],[-2,1,0],[1,1,2],[1,1,-2],[1,2,2],[1,1,-2],[1,2,2],[1,1,-2],[1,2,2],[1,1,-2]]}]}')},58:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n(0),r=n(27),c=n.n(r),s=(n(58),n(9)),i=n(7),l=n(5),j=n(6),d=n(79),b=n(81),u=n(82),h=n(83),O=n(84),f=n(85),g=n(86),p=n(11),x=n(87),m=n(40),y=[0,90,-90,-90,0,0],w=["x","y","z"],_=function(e){return Object(a.jsxs)("td",{children:[Object(a.jsx)("label",{children:w[e.index]}),Object(a.jsx)("input",{className:"PopupField",type:"text",name:w[e.index],value:e.target[e.index],onChange:function(t){var n=Object(s.a)(e.target);n[e.index]=t.target.value,e.setTarget(n)}})]})},v=function(e){return Object(a.jsxs)("div",{className:"Popup",children:[Object(a.jsx)("b",{children:"Target Coordinates"}),Object(a.jsxs)("form",{onSubmit:function(e){e.preventDefault()},children:[Object(a.jsx)("table",{children:Object(a.jsx)("tbody",{children:Object(a.jsxs)("tr",{children:[Object(a.jsx)(_,{target:e.target,setTarget:e.setTarget,index:0}),Object(a.jsx)(_,{target:e.target,setTarget:e.setTarget,index:1}),Object(a.jsx)(_,{target:e.target,setTarget:e.setTarget,index:2})]})})}),Object(a.jsx)("input",{type:"submit",style:{display:"none"}})]})]})},k=[{field:"name",headerName:"Task",width:70},{field:"length",headerName:"Length",width:30},{field:"desc",headerName:"Description",width:200}],A=function(e){var t=e.tasks,n=e.isPlaying,o=e.handlePlayStop,r=e.handleView;return Object(a.jsx)(d.a,{component:b.a,children:Object(a.jsxs)(u.a,{"aria-label":"tasks table",children:[Object(a.jsx)(h.a,{children:Object(a.jsxs)(O.a,{children:[k.map((function(e){return Object(a.jsx)(f.a,{style:{width:e.width},children:Object(a.jsx)("b",{children:e.headerName})},e.field)})),Object(a.jsx)(f.a,{})]})}),Object(a.jsx)(g.a,{children:t.map((function(e,t){return Object(a.jsxs)(O.a,{children:[Object(a.jsx)(f.a,{scope:"row",children:Object(a.jsx)("button",{className:"TableButton",onClick:function(){return r(t)},children:e.name})}),Object(a.jsx)(f.a,{children:e.length}),Object(a.jsx)(f.a,{children:e.desc}),Object(a.jsx)(f.a,{children:Object(a.jsx)("button",{className:n?"StopButton":"PlayButton",onClick:function(){return o(t)},children:n?Object(a.jsx)("i",{className:"fa fa-stop-circle fa-2x"}):Object(a.jsx)("i",{className:"fa fa-play-circle fa-2x"})})})]},t)}))})]})})},S=[{field:"e",headerName:"Base (E)",width:50},{field:"d",headerName:"Joint D",width:50},{field:"c",headerName:"Joint C",width:50},{field:"b",headerName:"Joint B",width:50},{field:"a",headerName:"Joint A",width:50},{field:"claw",headerName:"Claw",width:50}],T=[{field:"x",headerName:"X",width:100},{field:"y",headerName:"Y",width:100},{field:"z",headerName:"Z",width:100}],C=function(e){var t=e.tasks,n=e.changeTask,r=e.currentTask,c=e.isPlaying,i=e.handlePlayStop,l=e.handleView,p="control"===t[r].type?S:T,x=Object(o.useState)(t[r].data),m=Object(j.a)(x,2),y=m[0],w=m[1];return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h4",{children:t[r].name}),Object(a.jsxs)("div",{style:{color:"rgb(173, 173, 173)",marginTop:"-20px"},children:[Object(a.jsx)("button",{onClick:function(){return l(r)},style:{width:"50px"},children:Object(a.jsx)("i",{className:"fa fa-arrow-circle-left fa-2x"})}),Object(a.jsx)("button",{className:c?"StopButton":"PlayButton",style:{width:"50px"},onClick:function(){return i(r)},children:c?Object(a.jsx)("i",{className:"fa fa-stop-circle fa-2x"}):Object(a.jsx)("i",{className:"fa fa-play-circle fa-2x"})}),Object(a.jsx)("button",{type:"submit",form:t[r].name,style:{width:"50px"},children:Object(a.jsx)("i",{className:"fa fa-save fa-2x"})})]}),Object(a.jsxs)("form",{id:t[r].name,onSubmit:function(e){return n(e,y,r)},children:[Object(a.jsx)(d.a,{component:b.a,children:Object(a.jsxs)(u.a,{"aria-label":"tasks table",children:[Object(a.jsx)(h.a,{children:Object(a.jsx)(O.a,{children:p.map((function(e){return Object(a.jsx)(f.a,{style:{textAlign:"center",width:e.width},children:Object(a.jsx)("b",{children:e.headerName})},e.field)}))})}),Object(a.jsx)(g.a,{children:t[r].data.map((function(e,t){return Object(a.jsx)(O.a,{children:p.map((function(e,n){return Object(a.jsx)(f.a,{style:{textAlign:"center"},children:Object(a.jsx)("input",{className:"PopupField",style:{backgroundColor:"white",borderColor:"white"},type:"text",name:"".concat(t,",").concat(n),value:y[t][n],onChange:function(e){return function(e,t,n){var a=Object(s.a)(y);a[t][n]=e.target.value,w(a)}(e,t,n)}})},e.field)}))},t)}))})]})}),Object(a.jsx)("input",{type:"submit",style:{display:"none"}})]})]})},M=function(e){var t=Object(o.useState)(-1),n=Object(j.a)(t,2),r=n[0],c=n[1],s=e.tasks,i=e.changeTask,l=e.isPlaying,d=e.setIsPlaying,b=e.activeTask,u=e.setActiveTask,h=e.executeTask;function O(e){l&&-1!==b?(d(!1),u(-1)):l||-1!==b||(d(!0),u(e),h(e))}function f(e){c(-1===r?e:-1)}return Object(a.jsxs)("div",{className:"Menu",children:[Object(a.jsx)("div",{className:"MenuHeader",children:Object(a.jsx)("h3",{children:"TASKS"})}),Object(a.jsxs)("div",{className:"MenuBody",style:{height:"calc(100vh - 56px"},children:[Object(a.jsx)("br",{}),-1===r?Object(a.jsx)(A,{tasks:s,changeTask:null,currentTask:r,isPlaying:l,handlePlayStop:O,handleView:f}):Object(a.jsx)(C,{tasks:s,changeTask:i,currentTask:r,isPlaying:l,handlePlayStop:O,handleView:f})]})]})},P=function(e){var t=Object(o.useState)(!1),n=Object(j.a)(t,2),r=n[0],c=n[1],s=e.mode,i=function(e){c(!r)};return Object(a.jsx)("div",{className:"Record ".concat(s?"RecordAuto":"RecordControl"),children:r?Object(a.jsxs)(a.Fragment,{children:["Stop Recording:\xa0\xa0",Object(a.jsx)("button",{className:"RecordButton",onClick:i,children:Object(a.jsx)("i",{className:"fa fa-stop-circle fa-lg"})})]}):Object(a.jsxs)(a.Fragment,{children:["Start Recording:\xa0\xa0",Object(a.jsx)("button",{className:"RecordButton",onClick:i,children:Object(a.jsx)("i",{className:"fa fa-circle fa-lg"})})]})})},B=Object(p.a)({root:{color:"#2469c4",height:8,width:"90%"},thumb:{height:14,width:14,backgroundColor:"#cbcdcf",marginTop:-3,marginLeft:-7,"&:focus, &:hover, &$active":{boxShadow:"inherit"}},active:{},valueLabel:{left:"calc(-64%)"},track:{height:8,borderRadius:4},rail:{height:8,borderRadius:4}})(x.a),I=function(e){return Object(a.jsxs)("div",{className:"Menu",children:[Object(a.jsx)("div",{className:"MenuHeader",children:Object(a.jsx)("h3",{children:"Settings"})}),Object(a.jsxs)("div",{className:"MenuBody",children:[Object(a.jsx)("p",{children:"The following parameters are rotational velocities in radians per frame of movement."}),Object(a.jsx)("h4",{children:"Base Rotation"}),Object(a.jsx)(B,{value:e.base_theta_delta,valueLabelDisplay:"auto",track:"inverted",step:.01,min:.02,max:1,onChange:function(t,n){e.setBaseSpeed(n)}}),Object(a.jsx)("h4",{children:"Joint Rotation"}),Object(a.jsx)(B,{value:e.joints_theta_delta,valueLabelDisplay:"auto",track:"inverted",step:.01,min:.01,max:1,onChange:function(t,n){e.setJointSpeed(n)}}),Object(a.jsx)("h4",{children:"Wrist Rotation"}),Object(a.jsx)(B,{value:e.wrist_theta_delta,valueLabelDisplay:"auto",track:"inverted",step:.01,min:.01,max:1,onChange:function(t,n){e.setWristSpeed(n)}}),Object(a.jsx)("h4",{children:"Task Step Interval"}),Object(a.jsx)(B,{value:e.taskInterval,valueLabelDisplay:"auto",track:"inverted",step:100,min:500,max:8e3,onChange:function(t,n){e.setTaskInterval(n)}}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{})]})]})},N=function(){return Object(a.jsxs)("div",{className:"Menu",children:[Object(a.jsx)("div",{className:"MenuHeader",children:Object(a.jsx)("h3",{children:"HELP"})}),Object(a.jsxs)("div",{className:"MenuBody",children:[Object(a.jsxs)("h4",{children:[Object(a.jsx)("i",{className:"fa fa-arrows fa-lg"})," Control Mode"]}),Object(a.jsxs)("p",{children:["In control mode, the arm is directly controlled via the following keybindings:",Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)("code",{children:"ArrowRight/ArrowLeft"})," - Base E Yaw",Object(a.jsx)("br",{}),Object(a.jsx)("code",{children:"ArrowUp/ArrowDown"})," - Joint D Pitch",Object(a.jsx)("br",{}),Object(a.jsx)("code",{children:"R/F"})," - Joint C Pitch",Object(a.jsx)("br",{}),Object(a.jsx)("code",{children:"W/S"})," - Joint B Pitch",Object(a.jsx)("br",{}),Object(a.jsx)("code",{children:"D/A"})," - Wrist A Roll",Object(a.jsx)("br",{}),Object(a.jsx)("code",{children:"X/Z"})," - End Effector Open/Close",Object(a.jsx)("br",{}),"Tasks can be recorded in this mode by pressing the record button ",Object(a.jsx)("i",{className:"fa fa-plus-square-o fa-lg"}),"."]}),Object(a.jsxs)("h4",{children:[Object(a.jsx)("i",{className:"fa fa-magic fa-lg"})," Automatic Mode"]}),Object(a.jsxs)("p",{children:["In automatic mode, keyboard controls for the arm except for those for the wrist and claw are disabled, and the arm uses inverse kinematics the navigate by following inputed coordinates.",Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),"Target coordinates are indicated by an orange point can be changed through a popup tool or by dragging the point around. To drag the point, click the object to disable orbit controls and then use the mouse to drag it. Tasks can be recorded in this mode by pressing the record button ",Object(a.jsx)("i",{className:"fa fa-plus-square-o fa-lg"}),"."]}),Object(a.jsxs)("h4",{children:[Object(a.jsx)("i",{className:"fa fa-files-o fa-lg"})," Tasks"]}),Object(a.jsxs)("p",{children:["Tasks are lists of instructions that can program the arm to move in a predetermined pattern. ",Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),"Example instruction with arm angles:"]}),Object(a.jsxs)("pre",{children:["# Schema: angles in degrees ",Object(a.jsx)("br",{}),"# E  D  C  B  A Claw (0/1 = true/false)",Object(a.jsx)("br",{}),"90 40 30 90 120 0"]}),Object(a.jsx)("p",{children:"Example instruction with target positions: "}),Object(a.jsxs)("pre",{children:["# Schema: end effector positon ",Object(a.jsx)("br",{}),"# x   y   z ",Object(a.jsx)("br",{}),"1.56 5.87 2.35"]})]})]})},R=function(e){return Object(a.jsx)("li",{className:e.active?"active_opt":"",children:Object(a.jsx)("button",{onClick:e.handler,children:Object(a.jsx)("i",{className:"fa ".concat(e.icon," fa-2x")})})})};function E(e){var t=Object(o.useState)(!1),n=Object(j.a)(t,2),r=n[0],c=n[1],i=Object(o.useState)(!1),l=Object(j.a)(i,2),d=l[0],b=l[1],u=Object(o.useState)(!1),h=Object(j.a)(u,2),O=h[0],f=h[1],g=Object(o.useState)(!1),p=Object(j.a)(g,2),x=p[0],w=p[1],_=Object(o.useState)(m.a),k=Object(j.a)(_,2),A=k[0],S=k[1],T=Object(o.useState)(!1),C=Object(j.a)(T,2),B=C[0],E=C[1],K=Object(o.useState)(-1),D=Object(j.a)(K,2),F=D[0],H=D[1],L=Object(o.useState)(5e3),J=Object(j.a)(L,2),q=J[0],z=J[1];var V=function(t,n){if("control"===A[t].type){for(var a=Object(s.a)(A[t].data[n]),o=0;o<A[t].data[n].length-1;++o)a[o]*=.01745329;e.setControlAngles(a)}else"automatic"===A[t].type&&e.setTarget(A[t].data[n])};return Object(a.jsxs)("div",{style:{color:"white",position:"absolute",zIndex:2},children:[Object(a.jsxs)("ul",{children:[Object(a.jsx)(R,{icon:"fa-arrows",handler:e.setControlMode,active:!e.mode}),Object(a.jsx)(R,{icon:"fa-magic",handler:e.setAutomaticMode,active:e.mode}),Object(a.jsx)(R,{icon:"fa-files-o",handler:function(){d?b(!1):(r?c(!1):O&&f(!1),b(!0))},active:d}),Object(a.jsx)(R,{icon:"fa-plus-square-o",handler:function(){w(!x)},active:x}),Object(a.jsx)(R,{icon:"fa-tasks",handler:function(){O?f(!1):(d?b(!1):r&&c(!1),f(!0))},active:O}),Object(a.jsx)(R,{icon:"fa-question-circle-o",handler:function(){r?c(!1):(d?b(!1):O&&f(!1),c(!0))},active:r})]}),e.mode&&Object(a.jsx)(v,{target:e.target,setTarget:e.setTarget}),d&&Object(a.jsx)(M,{tasks:A,changeTask:function(e,t,n){e.preventDefault();var a=Object(s.a)(A);a[n].data=t,a[n].length=t.length,S(a),console.log(0)},isPlaying:B,setIsPlaying:E,activeTask:F,setActiveTask:H,executeTask:function(t){"control"===A[t].type&&(e.setControlMode(),e.setControlAngles(y),e.setControlTask(!0)),"automatic"===A[t].type&&e.setAutomaticMode();for(var n=q,a=A[t].data.length,o=function(e){setTimeout((function(){V(t,e)}),n),n+=q},r=0;r<a;++r)o(r);setTimeout((function(){e.setControlAngles(y)}),q*(a+1)),setTimeout((function(){e.setControlTask(!1)}),q*(a+2)),E(!1),H(-1)},controlTask:e.controlTask,setControlTask:e.setControlTask,setControlAngles:e.setControlAngles}),x&&Object(a.jsx)(P,{mode:e.mode,record:x}),O&&Object(a.jsx)(I,{base_theta_delta:e.base_theta_delta,joints_theta_delta:e.joints_theta_delta,wrist_theta_delta:e.wrist_theta_delta,setBaseSpeed:e.setBaseSpeed,setJointSpeed:e.setJointSpeed,setWristSpeed:e.setWristSpeed,taskInterval:q,setTaskInterval:z}),r&&Object(a.jsx)(N,{})]})}var K=n(13),D=n(50),F=n(45),H=n(46),L=n(2);function J(e,t){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function q(e){return Math.atan(e[1]/e[0])+Math.PI*(1-Math.sign(e[0]))/2}function z(e,t,n){for(var a=t[0],o=Object(s.a)(e[0]),r=1;r<t.length;++r)o[0]+=n[r]*Math.cos(a),o[1]+=n[r]*Math.sin(a),a+=t[r],e[r]=Object(s.a)(o);return e}function V(e,t,n,a,o){if(!(J([0,0],o)>a)){for(var r=z(e,t,n)[e.length-1],c=J(r,o),s=function(t,a,o){var r=J(e[t],e[a]),c=n[o]/r;e[a][0]=(1-c)*e[t][0]+c*e[a][0],e[a][1]=(1-c)*e[t][1]+c*e[a][1]};c>.01;){e[e.length-1]=o;for(var i=e.length-2;i>0;--i)s(i+1,i,i+1);for(var l=1;l<e.length-1;++l)s(l,l+1,l+1);c=J(r=e[e.length-1],o)}return function(e,t){for(var n=0,a=[0,0],o=1;o<t.length;++o){a[0]=e[o][0]-e[o-1][0],a[1]=e[o][1]-e[o-1][1];var r=q(a)-n;r>Math.PI?r-=2*Math.PI:r<-Math.PI&&(r+=2*Math.PI),t[o-1]=r,n+=r}return t}(e,t)}console.error("Target out of range:",o)}Object(K.b)({OrbitControls:F.a,DragControls:H.a});var W=new L.Vector3(1,0,0),G=new L.Vector3(0,0,1),U=.01,Z=[.35,.81,0],X=[.05,.15,.6],Y=[.5,.5,.5],$=(Math.PI,Math.PI,3*Math.PI/4+0),Q=[Math.PI/2,-Math.PI/2,-Math.PI/2,0],ee=[0,1.58,1.403,1.54],te=ee.reduce((function(e,t){return e+t})),ne={Finger1:{file:"models/linkage_finger1.obj",color:Y,position:[1.04,-.11,.15],rotation:[Math.PI,0,Math.PI],joint:[0,.14,.225],pos_key:"x",neg_key:"z"},Finger2:{file:"models/linkage_finger2.obj",color:Y,position:[1.04,.455,.05],rotation:[Math.PI,Math.PI,0],joint:[0,.12,.225],pos_key:"x",neg_key:"z"},HandCover:{file:"models/moment_body.obj",color:Y,position:[.666,0,.072],rotation:[0,Math.PI,0]},HandBase:{file:"models/torque_base.obj",color:Y,position:[.668,0,.176],rotation:[0,Math.PI,0]},HandCase:{file:"models/torque_servo.obj",color:X,position:[-.42,.08,.05],rotation:[-Math.PI/2,0,Math.PI],joint:[0,.16,.225],pos_key:"a",neg_key:"d"},AB:{file:"models/AB_stepper.obj",color:Y,position:[1.76,-.2,-.46],rotation:[0,0,Math.PI/2],joint:[1.58,.28,0],bounds:[-125,125],pos_key:"w",neg_key:"s"},BC:{file:"models/BC.obj",color:X,position:[.22,.38,.47],rotation:[Math.PI,Math.PI,Math.PI/2],joint:[.46,.18,0],bounds:[-125,125],pos_key:"r",neg_key:"f"},CD:{file:"models/CD.obj",color:Y,position:[.35,1.93,-.22],rotation:[-Math.PI,Math.PI,-Math.PI/2],joint:[.16,.81,0],bounds:[0,180],pos_key:"ArrowUp",neg_key:"ArrowDown"},BaseE1:{file:"models/BaseEnew.obj",color:X,position:[.32,-.02,.26],rotation:[-Math.PI/2,.24,Math.PI]},BaseE2:{file:"models/BaseEnewother.obj",color:X,position:[-.38,.14,.26],rotation:[-Math.PI/2,.24,0]},TurnTable:{file:"models/newTurntable.obj",color:X,position:[0,0,0],rotation:[Math.PI/2,Math.PI,-Math.PI/2]}},ae=function(e){var t=Object(o.useRef)(),n=Object(K.d)(D.a,e.file);return n.traverse((function(t){t instanceof L.Mesh&&(t.material=new L.MeshPhongMaterial,t.material.color.setRGB(e.color[0],e.color[1],e.color[2]))})),n.scale.set(U,U,U),Object(a.jsx)("mesh",Object(l.a)(Object(l.a)({},e),{},{ref:t,children:Object(a.jsx)("primitive",{object:n})}))},oe=function(e){var t=Object(o.useRef)(),n=Object(o.useRef)();function r(e,n){t.current&&(t.current.position.sub(e),t.current.position.applyAxisAngle(G,n),t.current.position.add(e))}return Object(K.c)((function(){n.current&&(e.controlKeys[ne.Finger1.pos_key]&&e.clawStep<60?(e.setClawStep(e.clawStep+1),r(n.current,-.004)):e.controlKeys[ne.Finger1.neg_key]&&e.clawStep>=0&&(e.setClawStep(e.clawStep-1),r(n.current,.004)),e.controlTask&&e.controlAngles.length>0&&(1===e.controlAngles[5]&&e.clawStep<60?(e.setClawStep(e.clawStep+1),r(n.current,-.004)):0===e.controlAngles[5]&&e.clawStep>=0&&(e.setClawStep(e.clawStep-1),r(n.current,.004))))})),Object(a.jsxs)("mesh",Object(l.a)(Object(l.a)({},e),{},{ref:t,children:[Object(a.jsx)(ae,{file:e.file,color:e.color}),Object(a.jsx)("vector3",{ref:n,args:ne.Finger1.joint})]}))},re=function(e){var t=Object(o.useRef)(),n=Object(o.useRef)();function r(e,n){t.current&&(t.current.position.sub(e),t.current.position.applyAxisAngle(G,-n),t.current.position.add(e))}return Object(K.c)((function(){n.current&&(e.controlKeys[ne.Finger2.pos_key]&&e.clawStep<60?(e.setClawStep(e.clawStep+1),r(n.current,-.004)):e.controlKeys[ne.Finger2.neg_key]&&e.clawStep>=0&&(e.setClawStep(e.clawStep-1),r(n.current,.004)),e.controlTask&&e.controlAngles.length>0&&(1===e.controlAngles[5]&&e.clawStep<60?(e.setClawStep(e.clawStep+1),r(n.current,-.004)):0===e.controlAngles[5]&&e.clawStep>=0&&(e.setClawStep(e.clawStep-1),r(n.current,.004))))})),Object(a.jsxs)("mesh",Object(l.a)(Object(l.a)({},e),{},{ref:t,children:[Object(a.jsx)(ae,{file:e.file,color:e.color}),Object(a.jsx)("vector3",{ref:n,args:ne.Finger2.joint})]}))},ce=function(e){var t=Object(o.useRef)(),n=Object(o.useRef)(),r=Object(o.useState)(0),c=Object(j.a)(r,2),s=c[0],i=c[1],d=Object(o.useState)(0),b=Object(j.a)(d,2),u=b[0],h=b[1];function O(e,n){t.current&&(t.current.position.sub(e),t.current.position.applyAxisAngle(W,n),t.current.position.add(e),t.current.rotateOnAxis(W,-n))}return Object(K.c)((function(){n.current&&(e.controlKeys[ne.HandCase.pos_key]?O(n.current,+e.wrist_theta_delta):e.controlKeys[ne.HandCase.neg_key]&&O(n.current,-e.wrist_theta_delta),e.controlTask&&e.controlAngles.length>0&&function(){if(n.current){var t=e.controlAngles[4]-u;Math.abs(t)<e.wrist_theta_delta?(O(n.current,t),h(e.controlAngles[4])):e.controlAngles[4]>u?(O(n.current,+e.wrist_theta_delta),h(u+e.wrist_theta_delta)):e.controlAngles[4]<u&&(O(n.current,-e.wrist_theta_delta),h(u-e.wrist_theta_delta))}}())})),Object(a.jsxs)("mesh",Object(l.a)(Object(l.a)({},e),{},{ref:t,children:[Object(a.jsx)(ae,{file:e.file,color:e.color}),Object(a.jsx)("vector3",{ref:n,args:ne.HandCase.joint}),Object(a.jsx)(ae,{file:ne.HandBase.file,color:ne.HandBase.color,position:ne.HandBase.position,rotation:ne.HandBase.rotation}),Object(a.jsx)(ae,{file:ne.HandCover.file,color:ne.HandCover.color,position:ne.HandCover.position,rotation:ne.HandCover.rotation}),Object(a.jsx)(oe,{controlKeys:e.controlKeys,file:ne.Finger1.file,color:ne.Finger1.color,position:ne.Finger1.position,rotation:ne.Finger1.rotation,clawStep:s,setClawStep:i,controlTask:e.controlTask,controlAngles:e.controlAngles}),Object(a.jsx)(re,{controlKeys:e.controlKeys,file:ne.Finger2.file,color:ne.Finger2.color,position:ne.Finger2.position,rotation:ne.Finger2.rotation,clawStep:s,setClawStep:i,controlTask:e.controlTask,controlAngles:e.controlAngles})]}))},se=function(e){var t=Object(o.useRef)(),n=Object(o.useRef)(),r=Object(o.useState)(Q[2]),c=Object(j.a)(r,2),s=c[0],i=c[1];function d(e,n){t.current&&(t.current.position.sub(e),t.current.position.applyAxisAngle(G,n),t.current.position.add(e),t.current.rotateOnAxis(G,n))}function b(){var t=e.joints_theta_delta;if(n.current){var a=e.angles[2]-s;Math.abs(a)<t?(d(n.current,a),i(e.angles[2])):e.angles[2]>s?(d(n.current,+t),i(s+t)):e.angles[2]<s&&(d(n.current,-t),i(s-t))}}return Object(K.c)((function(){var t=e.angles,a=e.setAngles,o=e.joints_theta_delta;n.current&&(e.controlKeys[ne.AB.pos_key]?(d(n.current,+o),a([t[0],t[1],t[2]+o,0]),i(t[2]+o)):e.controlKeys[ne.AB.neg_key]&&(d(n.current,-o),a([t[0],t[1],t[2]-o,0]),i(t[2]-o)),e.mode&&e.modeInit&&b(),e.controlTask&&e.controlAngles.length>0&&b())})),Object(a.jsxs)("mesh",Object(l.a)(Object(l.a)({},e),{},{ref:t,children:[Object(a.jsx)(ae,{file:e.file,color:e.color}),Object(a.jsx)("vector3",{ref:n,args:ne.AB.joint}),Object(a.jsx)(ce,{controlKeys:e.controlKeys,file:ne.HandCase.file,color:ne.HandCase.color,position:ne.HandCase.position,rotation:ne.HandCase.rotation,wrist_theta_delta:e.wrist_theta_delta,controlTask:e.controlTask,controlAngles:e.controlAngles})]}))},ie=function(e){var t=Object(o.useRef)(),n=Object(o.useRef)(),r=Object(o.useState)(Q[1]),c=Object(j.a)(r,2),s=c[0],i=c[1];function d(e,n){t.current&&(t.current.position.sub(e),t.current.position.applyAxisAngle(G,n),t.current.position.add(e),t.current.rotateOnAxis(G,n))}function b(){var t=e.joints_theta_delta;if(n.current){var a=e.angles[1]-s;Math.abs(a)<t?(d(n.current,a),i(e.angles[1])):e.angles[1]>s?(d(n.current,+t),i(s+t)):e.angles[1]<s&&(d(n.current,-t),i(s-t))}}return Object(K.c)((function(){var t=e.angles,a=e.setAngles,o=e.joints_theta_delta;n.current&&(e.controlKeys[ne.BC.pos_key]?(d(n.current,+o),a([t[0],t[1]+o,t[2],0]),i(t[1]+o)):e.controlKeys[ne.BC.neg_key]&&(d(n.current,-o),a([t[0],t[1]-o,t[2],0]),i(t[1]-o)),e.mode&&e.modeInit&&b(),e.controlTask&&e.controlAngles.length>0&&b())})),Object(a.jsxs)("mesh",Object(l.a)(Object(l.a)({},e),{},{ref:t,children:[Object(a.jsx)(ae,{file:e.file,color:e.color}),Object(a.jsx)("vector3",{ref:n,args:ne.BC.joint}),Object(a.jsx)(se,{controlKeys:e.controlKeys,file:ne.AB.file,color:ne.AB.color,position:ne.AB.position,rotation:ne.AB.rotation,joints_theta_delta:e.joints_theta_delta,wrist_theta_delta:e.wrist_theta_delta,angles:e.angles,setAngles:e.setAngles,mode:e.mode,modeInit:e.modeInit,controlTask:e.controlTask,controlAngles:e.controlAngles})]}))},le=function(e){var t=Object(o.useRef)(),n=Object(o.useRef)(),r=Object(o.useState)(Q[0]),c=Object(j.a)(r,2),s=c[0],i=c[1];function d(e,n){t.current&&(t.current.position.sub(e),t.current.position.applyAxisAngle(G,n),t.current.position.add(e),t.current.rotateOnAxis(G,n))}function b(){var t=e.joints_theta_delta;if(n.current){var a=e.angles[0]-s;Math.abs(a)<t?(d(n.current,a),i(e.angles[0])):e.angles[0]>s?(d(n.current,+t),i(s+t)):e.angles[0]<s&&(d(n.current,-t),i(s-t))}}return Object(K.c)((function(){var t=e.angles,a=e.setAngles,o=e.joints_theta_delta;n.current&&(e.controlKeys[ne.CD.pos_key]?(d(n.current,+o),a([t[0]+o,t[1],t[2],0]),i(t[0]+o)):e.controlKeys[ne.CD.neg_key]&&(d(n.current,-o),a([t[0]-o,t[1],t[2],0]),i(t[0]-o)),e.mode&&e.modeInit&&b(),e.controlTask&&e.controlAngles.length>0&&(a([e.controlAngles[1],e.controlAngles[2],e.controlAngles[3]]),b()))})),Object(a.jsxs)("mesh",Object(l.a)(Object(l.a)({},e),{},{ref:t,children:[Object(a.jsx)(ae,{file:e.file,color:e.color}),Object(a.jsx)("vector3",{ref:n,args:ne.CD.joint}),Object(a.jsx)(ie,{controlKeys:e.controlKeys,file:ne.BC.file,color:ne.BC.color,position:ne.BC.position,rotation:ne.BC.rotation,joints_theta_delta:e.joints_theta_delta,wrist_theta_delta:e.wrist_theta_delta,angles:e.angles,setAngles:e.setAngles,mode:e.mode,modeInit:e.modeInit,controlTask:e.controlTask,controlAngles:e.controlAngles})]}))},je=function(e){var t=Object(o.useRef)(),n=Object(o.useState)(!1),r=Object(j.a)(n,2),c=r[0],i=r[1],d=Object(o.useState)(Q),b=Object(j.a)(d,2),u=b[0],h=b[1],O=Object(o.useState)([[0,0],[0,0],[0,0],[0,0]]),f=Object(j.a)(O,2),g=f[0],p=f[1],x=Object(o.useState)(0),m=Object(j.a)(x,2),y=m[0],w=m[1],_=Object(o.useState)(0),v=Object(j.a)(_,2),k=v[0],A=v[1];function S(){var t=function(e){var t=[e[0],e[2]],n=q(t);return n>Math.PI?n-=2*Math.PI:n<-Math.PI&&(n+=2*Math.PI),{base_angle:n,target_2D:[J([0,0],t),e[1]]}}(e.target),n=t.base_angle,a=t.target_2D;a[1]-=Z[1],n-y>$?(n=-(Math.PI-n),a[0]=-(a[0]+Z[0])):n-y<-$?(n=Math.PI+n,a[0]=-(a[0]+Z[0])):a[0]-=Z[0],A(n);var o=V(Object(s.a)(g),Object(s.a)(u),ee,te,a);o&&h(o)}function T(){var n=e.base_theta_delta,a=Math.abs(k-y);t.current&&(a<n?(t.current.rotation.y=-k,w(k)):k>y?(t.current.rotation.y-=n,w(y+n)):k<y&&(t.current.rotation.y+=n,w(y-n)))}return Object(K.c)((function(){var n=e.mode,a=e.base_theta_delta;if(t.current){if(e.controlKeys.ArrowRight?(t.current.rotation.y-=a,A(k-a),w(y-a)):e.controlKeys.ArrowLeft&&(t.current.rotation.y+=a,A(k+a),w(y+a)),n&&!c){i(!0);var o=z(Object(s.a)(g),u,ee);p(o)}else!n&&c&&i(!1);n&&c&&(S(),T()),e.controlTask&&e.controlAngles.length>0&&(A(-e.controlAngles[0]),T())}})),Object(a.jsx)("mesh",Object(l.a)(Object(l.a)({},e),{},{ref:t,children:Object(a.jsxs)(o.Suspense,{fallback:Object(a.jsx)(be,{position:[1.2,0,0]}),children:[Object(a.jsx)(le,{controlKeys:e.controlKeys,file:ne.CD.file,color:ne.CD.color,position:ne.CD.position,rotation:ne.CD.rotation,joints_theta_delta:e.joints_theta_delta,wrist_theta_delta:e.wrist_theta_delta,angles:u,setAngles:h,mode:e.mode,modeInit:c,controlTask:e.controlTask,controlAngles:e.controlAngles}),Object(a.jsx)(ae,{file:ne.BaseE1.file,color:ne.BaseE1.color,position:ne.BaseE1.position,rotation:ne.BaseE1.rotation}),Object(a.jsx)(ae,{file:ne.BaseE2.file,color:ne.BaseE2.color,position:ne.BaseE2.position,rotation:ne.BaseE2.rotation}),Object(a.jsx)(ae,{file:ne.TurnTable.file,color:ne.TurnTable.color,position:ne.TurnTable.position,rotation:ne.TurnTable.rotation})]})}))},de=function(e){var t=Object(o.useRef)(),n=Object(o.useRef)(),r=Object(K.e)(),c=r.camera,s=r.gl.domElement;Object(K.c)((function(){!e.targetSelected&&t.current&&e.setTarget(t.current.position.toArray())}));return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("mesh",Object(l.a)(Object(l.a)({},e),{},{ref:t,onClick:function(t){e.targetSelected?e.setTargetSelected(!1):e.setTargetSelected(!0)},children:[Object(a.jsx)("sphereBufferGeometry",{args:[.08,16,16]}),Object(a.jsx)("meshPhongMaterial",{color:"orange"})]})),t.current&&Object(a.jsx)("dragControls",{ref:n,args:[[t.current],c,s]})]})},be=function(e){var t=Object(o.useRef)(),n=Object(o.useState)(!1),r=Object(j.a)(n,2),c=r[0],s=r[1],i=Object(o.useState)(!1),d=Object(j.a)(i,2),b=d[0],u=d[1];return Object(K.c)((function(){t.current&&(t.current.rotation.x=t.current.rotation.y+=.01)})),Object(a.jsxs)("mesh",Object(l.a)(Object(l.a)({},e),{},{ref:t,scale:b?[1.5,1.5,1.5]:[1,1,1],onClick:function(e){return u(!b)},onPointerOver:function(e){return s(!0)},onPointerOut:function(e){return s(!1)},children:[Object(a.jsx)("boxBufferGeometry",{args:[1,1,1]}),Object(a.jsx)("meshStandardMaterial",{color:c?"hotpink":"orange"})]}))},ue=function(){var e=Object(o.useRef)(),t=Object(K.e)(),n=t.camera,r=t.gl.domElement;return Object(o.useEffect)((function(){e.current&&(e.current.target=new L.Vector3(0,1.6,0))})),Object(K.c)((function(){e.current&&e.current.update()})),Object(a.jsx)("orbitControls",{ref:e,args:[n,r],enableZoom:!0})};function he(e){var t=Object(o.useState)(!1),n=Object(j.a)(t,2),r=n[0],c=n[1];return Object(a.jsx)("div",{className:"Render",children:Object(a.jsxs)(K.a,{camera:{position:[0,3,3]},children:[!r&&Object(a.jsx)(ue,{}),Object(a.jsx)("directionalLight",{intensity:.8}),Object(a.jsx)("gridHelper",{}),Object(a.jsx)("pointLight",{position:[0,10,20]}),e.mode&&Object(a.jsx)(de,{position:e.target,target:e.target,setTarget:e.setTarget,targetSelected:r,setTargetSelected:c}),Object(a.jsx)(je,{target:e.target,setTarget:null,wrist_theta_delta:e.wrist_theta_delta,joints_theta_delta:e.joints_theta_delta,base_theta_delta:e.base_theta_delta,mode:e.mode,controlKeys:e.controlKeys,controlTask:e.controlTask,setControlTask:e.setControlTask,controlAngles:e.controlAngles,setControlAngles:e.setControlAngles})]})})}function Oe(e){return Object(a.jsx)("div",{style:{height:"100vh",overflow:"hidden"},children:Object(a.jsx)(he,{mode:e.mode,controlKeys:e.controlKeys,target:e.target,setTarget:e.setTarget,base_theta_delta:e.base_theta_delta,joints_theta_delta:e.joints_theta_delta,wrist_theta_delta:e.wrist_theta_delta,controlTask:e.controlTask,setControlTask:e.setControlTask,controlAngles:e.controlAngles,setControlAngles:e.setControlAngles})})}n(66),n(67);var fe={ArrowUp:!1,ArrowDown:!1,ArrowLeft:!1,ArrowRight:!1,w:!1,s:!1,a:!1,d:!1,r:!1,f:!1,x:!1,z:!1},ge={a:!1,d:!1,x:!1,z:!1};function pe(){var e=Object(o.useState)(!1),t=Object(j.a)(e,2),n=t[0],r=t[1],c=Object(o.useState)(!1),d=Object(j.a)(c,2),b=d[0],u=d[1],h=Object(o.useState)([]),O=Object(j.a)(h,2),f=O[0],g=O[1],p=Object(o.useState)([[]]),x=Object(j.a)(p,2),m=x[0],y=x[1],w=Object(o.useState)(!1),_=Object(j.a)(w,2),v=_[0],k=_[1],A=Object(o.useState)([]),S=Object(j.a)(A,2),T=S[0],C=S[1],M=Object(o.useState)(fe),P=Object(j.a)(M,2),B=P[0],I=P[1],N=Object(o.useState)([1,0,0]),R=Object(j.a)(N,2),K=R[0],D=R[1],F=Object(o.useState)(.04),H=Object(j.a)(F,2),L=H[0],J=H[1],q=Object(o.useState)(.02),z=Object(j.a)(q,2),V=z[0],W=z[1],G=Object(o.useState)(.02),U=Object(j.a)(G,2),Z=U[0],X=U[1],Y=Object(o.useCallback)((function(e){I((function(t){return Object(l.a)(Object(l.a)({},t),{},Object(i.a)({},e.key,!0))}))}),[]),$=Object(o.useCallback)((function(e){I((function(t){return Object(l.a)(Object(l.a)({},t),{},Object(i.a)({},e.key,!1))}))}),[]),Q=Object(o.useCallback)((function(e){e.key in ge&&I((function(t){return Object(l.a)(Object(l.a)({},t),{},Object(i.a)({},e.key,!0))}))}),[]),ee=Object(o.useCallback)((function(e){e.key in ge&&I((function(t){return Object(l.a)(Object(l.a)({},t),{},Object(i.a)({},e.key,!1))}))}),[]);return Object(o.useEffect)((function(){window.addEventListener("keydown",Y,!0)}),[Y]),Object(o.useEffect)((function(){window.addEventListener("keyup",$,!0)}),[$]),Object(a.jsxs)("div",{className:"App",children:[Object(a.jsx)(E,{mode:n,setControlMode:function(){n&&(r(!1),window.removeEventListener("keydown",Q,!0),window.removeEventListener("keyup",ee,!0),window.addEventListener("keydown",Y,!0),window.addEventListener("keyup",$,!0))},setAutomaticMode:function(){n||(r(!0),I(fe),window.removeEventListener("keydown",Y,!0),window.removeEventListener("keyup",$,!0),window.addEventListener("keydown",Q,!0),window.addEventListener("keyup",ee,!0))},handleTaskRecord:function(){b?(u(!1),y([].concat(Object(s.a)(m),[f])),g([])):u(!0)},base_theta_delta:L,joints_theta_delta:V,wrist_theta_delta:Z,setBaseSpeed:J,setJointSpeed:W,setWristSpeed:X,target:K,setTarget:D,controlTask:v,setControlTask:k,setControlAngles:C}),Object(a.jsx)(Oe,{mode:n,controlKeys:B,target:K,setTarget:D,base_theta_delta:L,joints_theta_delta:V,wrist_theta_delta:Z,controlTask:v,setControlTask:k,controlAngles:T,setControlAngles:C})]})}c.a.render(Object(a.jsx)(pe,{}),document.getElementById("root"))}},[[68,1,2]]]);
//# sourceMappingURL=main.ede466f3.chunk.js.map